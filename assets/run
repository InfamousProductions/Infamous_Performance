
### PERFORMANCE CONTROL ###
zramstart(){
local cpus=$1;
local val=$2;
if busybox [ -f /system/lib/modules/zram.ko ]; then
    if busybox [ -z "`busybox lsmod | busybox grep zram`" ]; then
        busybox insmod /system/lib/modules/zram.ko;
    fi;
    busybox modprobe zram zram_num_devices=$cpus;
fi;
ncpus=`busybox expr $cpus - 1`;
for i in `busybox seq 0 $ncpus`; do
    busybox echo $val > /sys/block/zram$i/disksize;
done;
for i in `busybox seq 0 $ncpus`; do
    busybox mkswap /dev/block/zram$i;
done;
for i in `busybox seq 0 $ncpus`; do
    busybox swapon /dev/block/zram$i;
done;
return;
}

zramstop(){
local cpus=$1;
ncpus=`busybox expr $cpus - 1`;
for i in `busybox seq 0 $ncpus`; do
    busybox swapoff /dev/block/zram$i;
done;
sleep 1;
for i in `busybox seq 0 $ncpus`; do
    busybox echo 1 > /sys/block/zram$i/reset;
done;
sleep 1;
busybox modprobe -rf zram;
return;
}
