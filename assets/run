
### PERFORMANCE CONTROL ###
zramstart(){
cpus=$1;
val=$2;
if busybox [ -f /system/lib/modules/zram.ko ]; then
    if busybox [ -z "`busybox lsmod | busybox grep zram`" ]; then
        busybox insmod /system/lib/modules/zram.ko;
    fi;
    busybox modprobe zram zram_num_devices=$cpus;
fi;
ncpus=`busybox expr $cpus - 1`;
for i in `busybox seq 0 $ncpus`; do
    busybox echo $val > /sys/block/zram$i/disksize;
done;
for i in `busybox seq 0 $ncpus`; do
    busybox mkswap /dev/block/zram$i;
done;
for i in `busybox seq 0 $ncpus`; do
    busybox swapon /dev/block/zram$i;
done;
return;
}

zramstop(){
cpus=$1;
ncpus=`busybox expr $cpus - 1`;
for i in `busybox seq 0 $ncpus`; do
    busybox swapoff /dev/block/zram$i;
done;
sleep 1;
for i in `busybox seq 0 $ncpus`; do
    busybox echo 1 > /sys/block/zram$i/reset;
done;
sleep 1;
busybox modprobe -rf zram;
return;
}

get_cpu(){
    cpus=$1;
    ncpus=`busybox expr $cpus - 1`;
    ret="";
    sleep 1;
    for c in `busybox seq 0 $ncpus`; do
    max=`busybox cat /sys/devices/system/cpu/cpu$c/cpufreq/scaling_max_freq`;
    if busybox [ -f /sys/module/cpu_tegra/parameters/cpu_user_cap ]; then
        max=`busybox cat /sys/module/cpu_tegra/parameters/cpu_user_cap`;
    fi;
    if busybox [ -f /sys/power/cpufreq_max_limit ]; then
        max=`busybox cat /sys/power/cpufreq_max_limit`;
    fi;
    min=`busybox cat /sys/devices/system/cpu/cpu$c/cpufreq/scaling_min_freq`;
    if busybox [ -f /sys/power/cpufreq_min_limit ]; then
        min=`busybox cat /sys/power/cpufreq_min_limit`;
    fi;
    gov=`busybox cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor`;
    io=`busybox awk -F'[][]' '{print $2}' /sys/block/mmcblk0/queue/scheduler`;
    online=1;
    if busybox [ -f /sys/devices/system/cpu/cpu0/online ]; then
        online=`busybox cat /sys/devices/system/cpu/cpu0/online`;
    fi;
    if busybox [ "X$ret" == "X" ]; then
        ret="$min:$max:$gov:$io:$online";
    else
        ret="$ret:$min:$max:$gov:$io:$online";
    fi;
done;
echo "$ret";
}